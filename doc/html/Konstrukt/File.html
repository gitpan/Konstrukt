<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><head><title>Konstrukt::File</title>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" >
<link rel="stylesheet" title="cpan" type="text/css" href="../cpan.css" media="all" >

</head>
<body class='pod'>
<!--
  generated by Pod::Simple::CustomHTML v,
  using Pod::Simple::PullParser v2.02,
  under Perl v5.008008 at Tue Sep 26 20:07:25 2006 GMT.

 If you want to change this HTML document, you probably shouldn't do that
   by changing it directly.  Instead, see about changing the calling options
   to Pod::Simple::CustomHTML, and/or subclassing Pod::Simple::CustomHTML,
   then reconverting this document from the Pod source.
   When in doubt, email the author of Pod::Simple::CustomHTML for advice.
   See 'perldoc Pod::Simple::CustomHTML' for more info.

-->

<!-- start doc -->
<p class="backlinktop"><b><a name="___top" href="../index.html" accesskey="1" title="All Documents">&lt;&lt;</a></b></p>

<div class='indexgroup'>
<ul   class='indexList indexList1'>
  <li class='indexItem indexItem1'><a href='#NAME'>NAME</a>
  <li class='indexItem indexItem1'><a href='#SYNOPSIS'>SYNOPSIS</a>
  <li class='indexItem indexItem1'><a href='#DESCRIPTION'>DESCRIPTION</a>
  <li class='indexItem indexItem1'><a href='#METHODS'>METHODS</a>
  <ul   class='indexList indexList2'>
    <li class='indexItem indexItem2'><a href='#new'>new</a>
    <li class='indexItem indexItem2'><a href='#set_root'>set_root</a>
    <li class='indexItem indexItem2'><a href='#get_root'>get_root</a>
    <li class='indexItem indexItem2'><a href='#push'>push</a>
    <li class='indexItem indexItem2'><a href='#current_dir'>current_dir</a>
    <li class='indexItem indexItem2'><a href='#current_file'>current_file</a>
    <li class='indexItem indexItem2'><a href='#pop'>pop</a>
    <li class='indexItem indexItem2'><a href='#get_files'>get_files</a>
    <li class='indexItem indexItem2'><a href='#get_dirs'>get_dirs</a>
    <li class='indexItem indexItem2'><a href='#absolute_path'>absolute_path</a>
    <li class='indexItem indexItem2'><a href='#relative_path'>relative_path</a>
    <li class='indexItem indexItem2'><a href='#raw_read'>raw_read</a>
    <li class='indexItem indexItem2'><a href='#raw_write'>raw_write</a>
    <li class='indexItem indexItem2'><a href='#read_and_track'>read_and_track</a>
    <li class='indexItem indexItem2'><a href='#read'>read</a>
    <li class='indexItem indexItem2'><a href='#write'>write</a>
    <li class='indexItem indexItem2'><a href='#clean_path'>clean_path</a>
    <li class='indexItem indexItem2'><a href='#extract_path'>extract_path</a>
    <li class='indexItem indexItem2'><a href='#extract_file'>extract_file</a>
    <li class='indexItem indexItem2'><a href='#create_dirs'>create_dirs</a>
  </ul>
  <li class='indexItem indexItem1'><a href='#AUTHOR'>AUTHOR</a>
  <li class='indexItem indexItem1'><a href='#SEE_ALSO'>SEE ALSO</a>
</ul>
</div>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="NAME"
>NAME</a></h1>

<p>Konstrukt::File - Comfortable handling of files,
file names and paths</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="SYNOPSIS"
>SYNOPSIS</a></h1>

<pre>        #read a file with a path relative to the current path and set the current
        #path to the path of the read file and save the read file as current file
        $Konstrukt::File-&#62;read_and_track(&#39;realative/path/file&#39;);
        
        #change to the previous dir and file
        $Konstrukt::File-&#62;pop();
        
        #read a file with an absolute path with the document_root the root dir without
        #updating the current path and file
        $Konstrukt::File-&#62;read(&#39;/absolute/path/from/doc_root/file&#39;);
        
        #read a file without the built-in path mangling
        $Konstrukt::File-&#62;raw_read(&#39;/really/absolute/path/file&#39;);

        #write a file without the built-in path mangling
        $Konstrukt::File-&#62;raw_write(&#39;/really/absolute/path/file&#39;, &#39;some content&#39;);</pre>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="DESCRIPTION"
>DESCRIPTION</a></h1>

<p>This module allows to easily read files relatively to a your document root respectively to an imaginary current directory. So you don&#39;t have to care about generating the <i>real</i> path of a file.</p>

<p>Let&#39;s say you have this statement inside your webpage:</p>

<pre>        &#60;&#38; template src=&#34;/templates/layout.template&#34; / &#38;&#62;</pre>

<p>In fact this file isn&#39;t located in <code>/templates</code> on your system, it&#39;s located in <code>/.../your/document_root/templates</code>. So using</p>

<pre>        $Konstrukt::File-&#62;read_and_track(&#39;/templates/main.template&#39;);</pre>

<p>will just return the file located at <code>/.../your/document_root/templates</code> and update the current dir to the path of the read file. Within this template you may want to load another file:</p>

<pre>        &#60;&#38; template src=&#34;navigation/top.template&#34; / &#38;&#62;</pre>

<p>Actually this file is located at <code>/.../your/document_root/templates/navigation</code> as it is called from within the parent file, to which the path relates. This module will do this nasty path management for you.</p>

<p>To let the module know, when a file has been processed and you want to go back to the previous path, you must state:</p>

<pre>        $Konstrukt::File-&#62;pop();</pre>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="METHODS"
>METHODS</a></h1>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="new"
>new</a></h2>

<p>Constructor of this class</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="set_root"
>set_root</a></h2>

<p>Sets the root directory of this object and resets the current-dir-stack.</p>

<p><b>Parameters</b>:</p>

<ul>
<li>$root - The pseudo-root dir. Will be the root of a <code>$Konstrukt::File-</code>read(&#39;/path/file&#39;)&#62;. Usually your document root. Should always be an absolute path, otherwise you may get really weird results.</li>
</ul>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="get_root"
>get_root</a></h2>

<p>Returns the root directory (with a trailing slash) of this object.</p>

<p><b>Parameters</b>: none</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="push"
>push</a></h2>

<p>Saves the current file and its path. The paths will be the current &#34;working directory&#34;.</p>

<p>Usually only used internally. A plugin developer should rather use <a href="#read_and_track" class="podlinkpod"
>&#34;read_and_track&#34;</a> or <a href="#read" class="podlinkpod"
>&#34;read&#34;</a>.</p>

<p><b>Parameters</b>:</p>

<ul>
<li>$file - The absolute path to the filename</li>
</ul>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="current_dir"
>current_dir</a></h2>

<p>Returns the absolute path to the current virtual directory</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="current_file"
>current_file</a></h2>

<p>Returns the absolute path to the last file that has been read and tracked</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="pop"
>pop</a></h2>

<p>Returns to the directory and the file that has been current before we read and tracked a new file.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="get_files"
>get_files</a></h2>

<p>Returns the stack of the absolute path to the currently tracked files as an array.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="get_dirs"
>get_dirs</a></h2>

<p>Returns the stack of the absolute paths to the currently tracked dirs as an array.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="absolute_path"
>absolute_path</a></h2>

<p>Returns the full path to a partially given filename.</p>

<p>If the path begins with a / this / will be substituted with our root. Otherwise it is relative to our <a href="../current_dir.html" class="podlinkpod"
>current_dir</a>.</p>

<p><b>Parameters</b>:</p>

<ul>
<li>$path - The path</li>
</ul>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="relative_path"
>relative_path</a></h2>

<p>Returns the path from a given absolute filename relatively to the document root.</p>

<p>Example:</p>

<pre>        #assume that the document root is &#39;/foo/bar/&#39;
        /foo/bar/baz =&#62; baz
        /foo/bar/baz/bim/bam =&#62; baz/bim/bam
        /foo/baz =&#62; ../baz</pre>

<p><b>Parameters</b>:</p>

<ul>
<li>$path - The absolute path</li>
</ul>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="raw_read"
>raw_read</a></h2>

<p>Returns the content of a given filename as a scalar. Returns undef on error.</p>

<p>Will not care about the path management within this module.</p>

<p><b>Parameters</b>:</p>

<ul>
<li>$filename - The name of the file to read</li>

<li>$asref - Boolean value. If true, the result will be returned by reference to avoid copying of large data within the memory.</li>
</ul>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="raw_write"
>raw_write</a></h2>

<p>Writes a given scalars in the passed filename.</p>

<ul>
<li>$filename - The name of the file to write to</li>

<li>@scalars - The scalars which should be written to disk. May be references (which will be dereferenced).</li>
</ul>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="read_and_track"
>read_and_track</a></h2>

<p>Will read a file relatively to the current directory and will change the current directory to the one of the file that shall be read if no errors occured. Will also save the read file as the current file, which can be obtained with the <a href="#current_file" class="podlinkpod"
>&#34;current_file&#34;</a> method.</p>

<p>The root directory will be the one specified on construction of this object (usually your document root).</p>

<p>This method won&#39;t allow reading files outside the specified root. So $Konstrukt::File-&#62;read_and_track(&#39;/test.txt&#39;) will read the file test.txt located in the specified root, not in the system root.</p>

<p>A file read with this method will be put on a stack of &#34;open&#34; files. So all files read will be tracked as &#34;opened&#34;/&#34;currently used&#34;. If you&#39;re done with a file, you should call $Konstrukt::File-&#62;<a href="#pop" class="podlinkpod"
>&#34;pop&#34;</a> to remove it from the stack of currently used files. The &#60;/current_file&#62; method will then return the last filename.</p>

<p>This method will also add a (file date) cache condition (with the file and date of the read file) to each tracked (currently used) file. So if any of the files, which have been read after a file during a process, has changed until a next request the cache for this will be invalid as it is supposed that the file depends on the files which have been read as the file was tracked.</p>

<p><b>Parameters</b>:</p>

<ul>
<li>$filename - The name of the file to read relative to the current directory</li>

<li>$asref - Boolean value. If true, the result will be returned by reference to avoid copying of large data within the memory.</li>
</ul>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="read"
>read</a></h2>

<p>Will read a file relatively to the current directory.</p>

<p>The root directory will be the one specified on construction of this object (usually your document root).</p>

<p>This method won&#39;t allow reading files outside the specified root. So $Konstrukt::File-&#62;read(&#39;/test.txt&#39;) will read the file test.txt located in the specified root, not in the system root.</p>

<p><b>Parameters</b>:</p>

<ul>
<li>$filename - The name of the file to read</li>

<li>$asref - Boolean value. If true, the result will be returned by reference to avoid copying of large data within the memory.</li>
</ul>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="write"
>write</a></h2>

<p>Will write a file relatively to the current directory.</p>

<p>The root directory will be the one specified on construction of this object (usually your document root).</p>

<p>This method won&#39;t allow writing files outside the specified root. So $Konstrukt::File-&#62;write(&#39;/test.txt&#39;, &#39;some data&#39;) will (over)write the file test.txt located in the specified root, not in the system root.</p>

<p><b>Parameters</b>:</p>

<ul>
<li>$filename - The name of the file to write</li>

<li>@scalars - The scalars which should be written to disk. May be references (which will be dereferenced).</li>
</ul>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="clean_path"
>clean_path</a></h2>

<p>Returns a clean path.</p>

<p>Converts &#34;\&#34; to &#34;/&#34;, replaces everything to a &#34;//&#34; with &#34;/&#34;, removes everything to a &#34;Drive:\&#34; (MS paths), removes &#34;path/../&#34;, removes ./ and converts the path to lowercase on MS OSes.</p>

<ul>
<li>$path - The path</li>
</ul>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="extract_path"
>extract_path</a></h2>

<p>Extracts the path from a filename</p>

<ul>
<li>$filename - The filename</li>
</ul>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="extract_file"
>extract_file</a></h2>

<p>Extracts the filename from a full path to a file</p>

<ul>
<li>$filename - The filename</li>
</ul>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="create_dirs"
>create_dirs</a></h2>

<p>Creates non existing directories in a given path</p>

<ul>
<li>$path - The (absolute) path</li>
</ul>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="AUTHOR"
>AUTHOR</a></h1>

<p>Copyright 2006 Thomas Wittek (mail at gedankenkonstrukt dot de). All rights reserved.</p>

<p>This document is free software. It is distributed under the same terms as Perl itself.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="SEE_ALSO"
>SEE ALSO</a></h1>

<p><a href="../Konstrukt.html" class="podlinkpod"
>Konstrukt</a></p>
<p class="backlinkbottom"><b><a name="___bottom" href="../index.html" title="All Documents">&lt;&lt;</a></b></p>

<!-- end doc -->

</body></html>
